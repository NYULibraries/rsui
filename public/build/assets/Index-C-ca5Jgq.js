import{j as t,a as V,r as s,H as _,c as H}from"./app-B-SMFcR8.js";import{S as O,c as P}from"./app-logo-icon-CeAj1Gdf.js";import{c as T,a as C}from"./createLucideIcon-DOsiuD-Y.js";import{C as y,a as S,b as K,c as M,d as U}from"./card-UnbLGVAQ.js";import{I as B}from"./index-CZG6tVgv.js";import{m as F,S as $}from"./app-layout-DvLGCao6.js";import{L as G}from"./loader-circle-WXhtj_gx.js";/* empty css            */import"./index-BQ7f94Jo.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],k=T("Package",J),Q=P("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-auto",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function W({className:x,variant:c,asChild:i=!1,...n}){const l=i?O:"span";return t.jsx(l,{"data-slot":"badge",className:C(Q({variant:c}),x),...n})}function ne(){const{term:x,results:c,error:i}=V().props,[n,l]=s.useState(x||""),[d,R]=s.useState(c||[]),[p,j]=s.useState(!1),[w,r]=s.useState(!1),[o,m]=s.useState([]),[u,f]=s.useState(-1),g=s.useRef(null),v=s.useRef(null),A=[{title:"Search",href:"/search"}],h=e=>{e.trim()&&(j(!0),H.get("/search",{term:e},{preserveState:!0,onFinish:()=>j(!1)}))},I=async e=>{if(e.length<2){m([]),r(!1);return}try{const b=await(await fetch(`/api/search/autocomplete?term=${encodeURIComponent(e)}`)).json();m(b||[]),r(!0),f(-1)}catch(a){console.error("Autocomplete error:",a),m([]),r(!1)}},D=e=>{const a=e.target.value;l(a),a.length>=2?I(a):(m([]),r(!1))},E=e=>{if(!(!w||o.length===0))switch(e.key){case"ArrowDown":e.preventDefault(),f(a=>a<o.length-1?a+1:a);break;case"ArrowUp":e.preventDefault(),f(a=>a>-1?a-1:-1);break;case"Enter":if(e.preventDefault(),u>=0&&o[u]){const a=o[u];l(a.name),r(!1),h(a.name)}else h(n);break;case"Escape":r(!1),f(-1);break}},L=e=>{e.preventDefault(),r(!1),h(n)},z=e=>{l(e.name),r(!1),h(e.name)},N=e=>{v.current&&!v.current.contains(e.target)&&g.current&&!g.current.contains(e.target)&&r(!1)};return s.useEffect(()=>{R(c||[])},[c]),s.useEffect(()=>(document.addEventListener("mousedown",N),()=>{document.removeEventListener("mousedown",N)}),[]),t.jsxs(F,{breadcrumbs:A,children:[t.jsx(_,{title:"Search"}),t.jsxs("div",{className:"flex h-full flex-1 flex-col gap-6 rounded-xl p-4",children:[t.jsx("div",{className:"mx-auto w-full max-w-2xl",children:t.jsxs("form",{onSubmit:L,className:"relative",children:[t.jsxs("div",{className:"relative",children:[t.jsx($,{className:"absolute top-1/2 left-3 h-4 w-4 -translate-y-1/2 transform text-muted-foreground"}),t.jsx(B,{ref:g,type:"text",placeholder:"Search packages...",value:n,onChange:D,onKeyDown:E,className:"h-12 pr-12 pl-10 text-base",disabled:p}),p&&t.jsx(G,{className:"absolute top-1/2 right-3 h-4 w-4 -translate-y-1/2 transform animate-spin text-muted-foreground"})]}),w&&o.length>0&&t.jsx("div",{ref:v,className:"absolute top-full right-0 left-0 z-50 mt-1 max-h-60 overflow-auto rounded-md border bg-popover shadow-lg",children:o.map((e,a)=>t.jsxs("div",{className:C("flex cursor-pointer items-center gap-2 px-3 py-2 hover:bg-accent hover:text-accent-foreground",u===a&&"bg-accent text-accent-foreground"),onClick:()=>z(e),children:[t.jsx(k,{className:"h-4 w-4 text-muted-foreground"}),t.jsxs("div",{className:"min-w-0 flex-1",children:[t.jsx("div",{className:"truncate font-medium",children:e.name}),e.description&&t.jsx("div",{className:"truncate text-sm text-muted-foreground",children:e.description})]})]},e.id))})]})}),i&&t.jsx(y,{className:"mx-auto w-full max-w-2xl border-destructive",children:t.jsx(S,{className:"pt-6",children:t.jsx("div",{className:"text-destructive",children:i})})}),d.length>0&&t.jsxs("div",{className:"mx-auto w-full max-w-4xl",children:[t.jsxs("h2",{className:"mb-4 text-2xl font-semibold",children:["Search Results (",d.length,")"]}),t.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:d.map(e=>t.jsxs(y,{className:"transition-shadow hover:shadow-md",children:[t.jsxs(K,{children:[t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs(M,{className:"flex items-center gap-2 text-lg",children:[t.jsx(k,{className:"h-5 w-5 text-muted-foreground"}),e.name]}),e.type&&t.jsx(W,{variant:"secondary",children:e.type})]}),e.description&&t.jsx(U,{className:"line-clamp-2",children:e.description})]}),t.jsx(S,{children:e.metadata&&Object.keys(e.metadata).length>0&&t.jsx("div",{className:"space-y-2",children:Object.entries(e.metadata).slice(0,3).map(([a,b])=>t.jsxs("div",{className:"flex justify-between text-sm",children:[t.jsxs("span",{className:"text-muted-foreground capitalize",children:[a.replace(/_/g," "),":"]}),t.jsx("span",{className:"font-medium",children:String(b)})]},a))})})]},e.id))})]}),n&&!p&&d.length===0&&!i&&t.jsx("div",{className:"mx-auto w-full max-w-2xl text-center",children:t.jsxs("div",{className:"text-muted-foreground",children:['No results found for "',n,'"']})})]})]})}export{ne as default};
